<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pokémon Type Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    h1, h2 {
      margin-bottom: 10px;
    }
    .type-grid {
      display: flex;
      flex-wrap: wrap;
      max-width: 600px;
    }
    .type-button {
      flex: 1 0 20%;
      box-sizing: border-box;
      margin: 5px;
      padding: 10px 15px;
      border: 2px solid #333;
      border-radius: 5px;
      cursor: pointer;
      user-select: none;
      text-align: center;
      color: white;
      position: relative;
    }
    .selected {
      outline: 3px solid #4caf50;
      outline-offset: -3px;
      box-shadow: 0 0 6px #4caf50;
    }
    button {
      margin-top: 15px;
      padding: 10px 20px;
      margin-right: 10px;
      border: none;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
    }
    button.calculate { background-color: #2196F3; color: white; }
    button.clear     { background-color: #f44336; color: white; }
    button.toggle    { background-color: #9C27B0; color: white; }
    button.matrix    { background-color: #607D8B; color: white; }
    table {
      margin-top: 20px;
      border-collapse: collapse;
    }
    th, td {
      padding: 8px 12px;
      border: 1px solid #ccc;
      text-align: center;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <h1>Pokémon Type Effectiveness Calculator</h1>

  <button class="toggle" onclick="toggleMode()">Switch to Attacker Mode</button>

  <div id="typeButtons" class="type-grid"></div>

  <button class="calculate" onclick="calculate()">Calculate</button>
  <button class="clear" onclick="clearSelection()">Clear Selection</button>
  <button class="matrix" onclick="showMatrix()">Show Matrix</button>
  <button class="matrix" onclick="printPage()">Print / Export</button>

  <h2 id="modeLabel">Current Mode: Defender → Shows best attacking types</h2>

  <table id="resultTable" class="hidden">
    <thead><tr><th>Type</th><th>Effectiveness</th></tr></thead>
    <tbody></tbody>
  </table>

  <div id="matrixContainer" class="hidden"></div>

  <script>
    const typeChart = {
      Normal:     { Rock: 0.5, Ghost: 0, Steel: 0.5 },
      Fire:       { Fire: 0.5, Water: 0.5, Grass: 2, Ice: 2, Bug: 2, Rock: 0.5, Dragon: 0.5, Steel: 2 },
      Water:      { Fire: 2, Water: 0.5, Grass: 0.5, Ground: 2, Rock: 2, Dragon: 0.5 },
      Grass:      { Fire: 0.5, Water: 2, Grass: 0.5, Poison: 0.5, Ground: 2, Flying: 0.5, Bug: 0.5, Rock: 2, Dragon: 0.5, Steel: 0.5 },
      Electric:   { Water: 2, Electric: 0.5, Grass: 0.5, Ground: 0, Flying: 2, Dragon: 0.5 },
      Ice:        { Fire: 0.5, Water: 0.5, Grass: 2, Ice: 0.5, Ground: 2, Flying: 2, Dragon: 2, Steel: 0.5 },
      Fighting:   { Normal: 2, Ice: 2, Poison: 0.5, Flying: 0.5, Psychic: 0.5, Bug: 0.5, Rock: 2, Ghost: 0, Dark: 2, Steel: 2, Fairy: 0.5 },
      Poison:     { Grass: 2, Poison: 0.5, Ground: 0.5, Rock: 0.5, Ghost: 0.5, Steel: 0, Fairy: 2 },
      Ground:     { Fire: 2, Electric: 2, Grass: 0.5, Poison: 2, Flying: 0, Bug: 0.5, Rock: 2, Steel: 2 },
      Flying:     { Electric: 0.5, Grass: 2, Fighting: 2, Bug: 2, Rock: 0.5, Steel: 0.5 },
      Psychic:    { Fighting: 2, Poison: 2, Psychic: 0.5, Dark: 0, Steel: 0.5 },
      Bug:        { Fire: 0.5, Grass: 2, Fighting: 0.5, Poison: 0.5, Flying: 0.5, Psychic: 2, Ghost: 0.5, Dark: 2, Steel: 0.5, Fairy: 0.5 },
      Rock:       { Fire: 2, Ice: 2, Fighting: 0.5, Ground: 0.5, Flying: 2, Bug: 2, Steel: 0.5 },
      Ghost:      { Normal: 0, Psychic: 2, Ghost: 2, Dark: 0.5 },
      Dragon:     { Dragon: 2, Steel: 0.5, Fairy: 0 },
      Dark:       { Fighting: 0.5, Psychic: 2, Ghost: 2, Dark: 0.5, Fairy: 0.5 },
      Steel:      { Fire: 0.5, Water: 0.5, Electric: 0.5, Ice: 2, Rock: 2, Fairy: 2, Steel: 0.5 },
      Fairy:      { Fire: 0.5, Fighting: 2, Poison: 0.5, Dragon: 2, Dark: 2, Steel: 0.5 }
    };

    const typeColors = {
      Normal: '#A8A77A', Fire: '#EE8130', Water: '#6390F0', Electric: '#F7D02C', Grass: '#7AC74C',
      Ice: '#96D9D6', Fighting: '#C22E28', Poison: '#A33EA1', Ground: '#E2BF65', Flying: '#A98FF3',
      Psychic: '#F95587', Bug: '#A6B91A', Rock: '#B6A136', Ghost: '#735797', Dragon: '#6F35FC',
      Dark: '#705746', Steel: '#B7B7CE', Fairy: '#D685AD'
    };

    const typeList = Object.keys(typeChart).sort();
    const typeButtonsContainer = document.getElementById('typeButtons');
    let selectedTypes = [];
    let attackerMode = false;

    function toggleMode() {
      attackerMode = !attackerMode;
      clearSelection();
      document.querySelector('.toggle').textContent = attackerMode ? 'Switch to Defender Mode' : 'Switch to Attacker Mode';
      document.getElementById('modeLabel').textContent = attackerMode
        ? 'Current Mode: Attacker → Shows what your type is strong/weak against'
        : 'Current Mode: Defender → Shows best attacking types';
    }

    typeList.forEach(type => {
      const btn = document.createElement('div');
      btn.className = 'type-button';
      btn.textContent = type;
      btn.style.backgroundColor = typeColors[type];
      btn.title = `${type}: Strong against ${getStrengths(type).join(', ')}`;
      btn.onclick = () => {
        if (selectedTypes.includes(type)) {
          selectedTypes = selectedTypes.filter(t => t !== type);
          btn.classList.remove('selected');
        } else {
          if ((attackerMode && selectedTypes.length < 1) || (!attackerMode && selectedTypes.length < 2)) {
            selectedTypes.push(type);
            btn.classList.add('selected');
          }
        }
      };
      typeButtonsContainer.appendChild(btn);
    });

    function getStrengths(type) {
      const targets = typeChart[type] || {};
      return Object.keys(targets).filter(k => targets[k] > 1);
    }

    function clearSelection() {
      selectedTypes = [];
      document.querySelectorAll('.type-button').forEach(btn => btn.classList.remove('selected'));
      document.getElementById('resultTable').classList.add('hidden');
      document.getElementById('matrixContainer').classList.add('hidden');
    }

    function calculate() {
      const tbody = document.querySelector('#resultTable tbody');
      tbody.innerHTML = '';
      document.getElementById('matrixContainer').classList.add('hidden');

      const effectiveness = {};

      if (attackerMode) {
        const atk = selectedTypes[0];
        if (!atk) return;
        for (const defType in typeColors) {
          let eff = typeChart[atk]?.[defType] ?? 1;
          effectiveness[defType] = eff;
        }
      } else {
        const [d1, d2] = selectedTypes;
        for (const atk in typeChart) {
          let eff = 1;
          if (typeChart[atk][d1] !== undefined) eff *= typeChart[atk][d1];
          if (d2 && typeChart[atk][d2] !== undefined) eff *= typeChart[atk][d2];
          effectiveness[atk] = eff;
        }
      }

      const sorted = Object.entries(effectiveness)
        .filter(([_, m]) => m !== 1)
        .sort((a, b) => b[1] - a[1]);

      (sorted.length ? sorted : [['None', 1]]).forEach(([type, eff]) => {
        const row = tbody.insertRow();
        row.insertCell(0).textContent = type;
        row.insertCell(1).textContent = eff;
      });

      document.getElementById('resultTable').classList.remove('hidden');
    }

    function showMatrix() {
      const container = document.getElementById('matrixContainer');
      container.innerHTML = '';
      const table = document.createElement('table');
      const header = table.insertRow();
      header.insertCell(); // blank corner
      typeList.forEach(t => {
        const th = document.createElement('th');
        th.textContent = t;
        header.appendChild(th);
      });

      typeList.forEach(atk => {
        const row = table.insertRow();
        const th = document.createElement('th');
        th.textContent = atk;
        row.appendChild(th);
        typeList.forEach(def => {
          const cell = row.insertCell();
          const val = typeChart[atk]?.[def] ?? 1;
          cell.textContent = val;
        });
      });

      container.appendChild(table);
      container.classList.remove('hidden');
    }

    function printPage() {
      window.print();
    }
  </script>
</body>
</html>
